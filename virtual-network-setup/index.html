<!-- build time:Sun Oct 27 2024 23:45:18 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="命运转轮" href="https://arachnid.cc/rss.xml"><link rel="alternate" type="application/atom+xml" title="命运转轮" href="https://arachnid.cc/atom.xml"><link rel="alternate" type="application/json" title="命运转轮" href="https://arachnid.cc/feed.json"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="Ubuntu,Linux"><link rel="canonical" href="https://arachnid.cc/virtual-network-setup/"><title>vmware 下 Ubuntu 双网卡设置 | Arachnid's blog = 命运转轮 = Life is ...the time you did something you're afraid of doing</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="loader-state"><svg viewBox="0 0 178 40" width="178" height="40"><path class="air" d="M 46 16.5 h -20 a 8 8 0 0 1 0 -16" fill="none" stroke="#E85725" stroke-width="1" stroke-linejoin="round" stroke-linecap="round"></path><g id="car"><svg viewBox="0 0 118 28.125" x="30" y="11.725" width="118" height="28.125"><defs><circle id="circle" cx="0" cy="0" r="1"></circle><g id="wheel"><use href="#circle" fill="#1E191A" transform="scale(10)"></use><use href="#circle" fill="#fff" transform="scale(5)"></use><path fill="#1E191A" stroke="#1E191A" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round" opacity="0.2" stroke-dashoffset="0" d="M -3.5 0 a 4 4 0 0 1 7 0 a 3.5 3.5 0 0 0 -7 0"></path><use href="#circle" fill="#1E191A" transform="scale(1.5)"></use><path fill="none" stroke="#F9B35C" stroke-width="0.75" stroke-linecap="round" stroke-linejoin="round" stroke-dasharray="20 14 8 5" d="M 0 -7.5 a 7.5 7.5 0 0 1 0 15 a 7.5 7.5 0 0 1 0 -15"></path><path fill="none" stroke="#fff" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" opacity="0.1" stroke-dashoffset="0" d="M -6.5 -6.25 a 10 10 0 0 1 13 0 a 9 9 0 0 0 -13 0"></path></g></defs><g transform="translate(51.5 11.125)"><path stroke-width="2" stroke="#1E191A" fill="#EF3F33" d="M 0 0 v -2 a 4.5 4.5 0 0 1 9 0 v 2"></path><rect fill="#1E191A" x="3.25" y="-3" width="5" height="3"></rect></g><g transform="translate(10 24.125)"><g transform="translate(59 0)"><path id="shadow" opacity="0.7" fill="#1E191A" d="M -64 0 l -4 4 h 9 l 8 -1.5 h 100 l -3.5 -2.5"></path></g><path fill="#fff" stroke="#1E191A" stroke-width="2.25" stroke-linecap="round" stroke-linejoin="round" d="M 0 0 v -10 l 35 -13 v 5 l 4 0.5 l 0.5 4.5 h 35.5 l 30 13"></path><g fill="#fff" stroke="#1E191A" stroke-width="2.25" stroke-linecap="round" stroke-linejoin="round"><path d="M -6 0 v -22 h 10 z"></path><path d="M 105 0 h -3 l -12 -5.2 v 6.2 h 12"></path></g><g fill="#949699" opacity="0.7"><rect x="16" y="-6" width="55" height="6"></rect><path d="M 24 -14 l 13 -1.85 v 1.85"></path></g><g fill="none" stroke="#1E191A" stroke-width="2.25" stroke-linecap="round" stroke-linejoin="round"><path stroke-dasharray="30 7 42" d="M 90 0 h -78"></path><path d="M 39.5 -13 h -15"></path></g><path fill="#fff" stroke="#1E191A" stroke-width="2.25" stroke-linejoin="round" d="M 48.125 -6 h -29 v 6 h 29"></path><rect x="48" y="-7.125" width="6.125" height="7.125" fill="#1E191A"></rect><g fill="#1E191A"><rect x="60" y="-15" width="1" height="6"></rect><rect x="56.5" y="-17.5" width="6" height="2.5"></rect></g></g><g class="wheels" transform="translate(0 18.125)"><g transform="translate(10 0)"><use href="#wheel"></use></g><g transform="translate(87 0)"><use href="#wheel" stroke-dashoffset="-22"></use></g></g></svg></g><g fill="none" stroke-width="1" stroke-linejoin="round" stroke-linecap="round"><path class="air" stroke="#E85725" d="M 177.5 34 h -10 q -16 0 -32 -8"></path><path class="air" stroke="#949699" d="M 167 28.5 c -18 -2 -22 -8 -37 -10.75"></path><path class="air" stroke="#949699" d="M 153 20 q -4 -1.7 -8 -3"></path><path class="air" stroke="#E85725" d="M 117 16.85 c -12 0 -12 16 -24 16 h -8"></path><path class="air" stroke="#949699" d="M 65 12 q -5 3 -12 3.8"></path><path class="air" stroke="#949699" stroke-dasharray="9 10" d="M 30 13.5 h -2.5 q -5 0 -5 -5"></path><path class="air" stroke="#949699" d="M 31 33 h -10"></path><path class="air" stroke="#949699" d="M 29.5 23 h -12"></path><path class="air" stroke="#949699" d="M 13.5 23 h -6"></path><path class="air" stroke="#E85725" d="M 28 28 h -27.5"></path></g></svg></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">vmware 下 Ubuntu 双网卡设置<i class="ic i-link-alt"></i></h1><div class="meta"><span class="item" title="创建时间：2023-02-25 17:28:19"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2023-02-25T17:28:19+08:00">2023-02-25</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>4.2k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>4 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Arachnid's blog</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://arachnid.cc/picture/(29).webp"></li><li class="item" data-background-image="https://arachnid.cc/picture/(16).webp"></li><li class="item" data-background-image="https://arachnid.cc/picture/(11).webp"></li><li class="item" data-background-image="https://arachnid.cc/picture/(1).webp"></li><li class="item" data-background-image="https://arachnid.cc/picture/(34).webp"></li><li class="item" data-background-image="https://arachnid.cc/picture/(8).webp"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="cn"><link itemprop="mainEntityOfPage" href="https://arachnid.cc/virtual-network-setup/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.webp"><meta itemprop="name" content="夏沫の浅雨"><meta itemprop="description" content="Life is ...the time you did something you're afraid of doing, 不曾亏欠，不曾辜负，如此足矣"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="命运转轮"></span><div class="body md" itemprop="articleBody"><blockquote><p>背景：主机电脑通过 WiFi 上网，网口用于跟开发板等设备有线连接；为此需要实现虚拟机内对系统可以进行外网访问网页或下载工具包等（避免切换主机操作），同时具备通过网线访问内网设备机器进行控制调试等操作。</p><p>环境：VMware® Workstation 15 Pro</p><p>平台：Ubuntu 18.04.6</p></blockquote><h1 id="step-1添加网卡"><a class="anchor" href="#step-1添加网卡">#</a> step 1：添加网卡</h1><p>在虚拟机窗口栏，依次点击 <code>编辑</code> -&gt; <code>虚拟网络编辑器</code> ，可以看到原有默认的 VMnet 接口：</p><p><img data-src="image-20230225172822709.png" alt="image-20230225172822709"></p><p>它们分别对应主机 ip 地址。</p><p>然后我们建立一个桥接模式的 VMnet 虚拟网络，并指定响应网卡（如出现灰屏无法设置，需要<strong>以管理员身份打开</strong> VMware，或在当前窗口点击 <code>更改设置</code> 来赋予权限），然后选择对应需要进行桥接的网卡（即网口网卡）：</p><p><img data-src="image-20230225193931835.png" alt="image-20230225193931835"></p><h1 id="setp-2配置网络设备器"><a class="anchor" href="#setp-2配置网络设备器">#</a> setp 2：配置网络设备器</h1><p>在 ubuntu 虚拟机右键点击 <code>设置</code> -&gt; <code>添加</code> -&gt; <code>网络适配器</code> ，然后指定上面配置为桥接模式的 VMnet 虚拟网络：</p><p><img data-src="image-20230225194908857.png" alt="image-20230225194908857"></p><h2 id="拓展"><a class="anchor" href="#拓展">#</a> 拓展</h2><p>关于 NAT（网络地址转换模式）、Host-only（主机模式）及 bridged（桥接模式）：</p><p><img data-src="Perbedaan-NAT-Bridge-Dan-Host-Only-Di-Vmware-Dan-Virtualbox-1170x731.jpg" alt="Perbedaan NAT Bridge Dan Host Only"></p><ul><li><p>NAT 模式：使用 NAT 模式，就是让虚拟机借助 NAT （网络地址转换）功能，通过宿主机器所在的网络来访问外部网络，即：使用 NAT 模式可以实现在虚拟系统里访问互联网。</p><p>优点：是从虚拟机访问外部网络的最简单方法；通常，它会自动设置网络地址转换到虚拟机上，不需要在宿主机器的网络信息上配置或通过访客操作系统上进行配置。</p><p>缺点：就像路由器后面的专用网络一样，虚拟机是不可见的，无法从外部网络访问。</p><p><img data-src="Virtual_network_switch_in_nat_mode.png" alt="vmware-network-nat"></p></li><li><p>Host-only 模式：构建一个与外界断开连接的内部网络，只允许使用 host-only 方法的虚拟机才能通信，因此无法与外部网络或其他 PC 主机通信，只能相互通信。</p><p>优点：与内部网络一样，其不需要存在物理网络接口，相当于使用 host-only 方法的虚拟机通过双绞线直连形成网络节点进行通讯；由于无法访问外部网络，因此对于安全性来讲，比其余两种相对要高。</p><p>缺点：如其名，无法与主机外部的网络通信，同时外部网络设备也无法与其通讯。</p><p><img data-src="Virtual_network_switch_in_host-only_mode.png" alt="vmware-network-hostonly"></p></li><li><p>bridged 模式：在这种模式下，虚拟系统就像是局域网中的一台独立的主机，具有自己的 MAC 和 IP 地址；由于虚拟机和宿主机器分配了相同网段的 IP，因此宿主机器和虚拟机被识别为同一级别的物理主机。</p><p>优点：虚拟机就像是一台独立的主机，拥有正常主机的网络功能，可以对外部网络进行访问，而外部网络也可以访问进来。</p><p>缺点：由于外部网络可以访问，其安全性比其余两种相对要低；因与宿主机器平等的存在于网络中，需要进行分配网络地址、子网掩码、网关等操作。</p><p><img data-src="Virtual_network_switch_in_bridged_mode.png" alt="vmware-network-bridged"></p></li></ul><p>示例：</p><p>一些 VMnet 虚拟机具有特定功能：VMnet0 专用于 bridged 模式，VMnet1 专用于 host-only 模式，而 VMnet8 专用于 NAT 模式；其他的 VMnet2 等，可供虚拟机使用自定义网络模式。如图分析各模式作用：</p><p><img data-src="workstation-networking_thumb1.jpg" alt="工作站网络"></p><ul><li><p>VM-1 可以与 host PC 通信，并连接到外部 LAN or internet，但不能与 NAT 和 host-only 网络通信。</p></li><li><p>VM-2 和 VM-3 可以相互通信，也可以与 NAT 网络中的其他 VM 通信，也可以与 host PC 通信。</p></li><li><p>VM-5 和 VM-4 可以相互通信，但不能与主机操作系统和 host-only 网络中的其他 VM 通信。</p></li><li><p>VM-6 和 VM-7 无法相互通信。</p></li></ul><p>参考：</p><p><span class="exturl" data-url="aHR0cHM6Ly9zdXBlcnVzZXIuY29tL3F1ZXN0aW9ucy8yMjc1MDUvd2hhdC1pcy10aGUtZGlmZmVyZW5jZS1iZXR3ZWVuLW5hdC1icmlkZ2VkLWhvc3Qtb25seS1uZXR3b3JraW5n">What is the difference between NAT / Bridged / Host-Only networking?</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9waWJ5dGVzLndvcmRwcmVzcy5jb20vMjAxMi8xMS8xNi92bXdhcmUtd29ya3N0YXRpb24tbmV0d29ya2luZy1iYXNpY3Mv">VMware Workstation Networking Basics</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9hZ3Vzc2FzLndvcmRwcmVzcy5jb20vMjAxNS8xMC8yOC92bXdhcmUtbmV0d29ya2luZy1jb25jZXB0LWJyaWRnZWQtbmF0LWhvc3Qtb25seS1sYW4tc2VnbWVudC8=">VMWare Networking Concept [Bridged, NAT, Host Only, LAN Segment]</span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cubW9uaXRvcnRla25vbG9naS5jb20vcGVyYmVkYWFuLW5hdC1icmlkZ2UtZGFuLWhvc3Qtb25seS8=">Perbedaan NAT Bridge Dan Host Only Di VMware Dan VirtualBox</span></p><p><span class="exturl" data-url="aHR0cHM6Ly93aWtpLmxpYnZpcnQub3JnL1ZpcnR1YWxOZXR3b3JraW5nLmh0bWw=">Virtual Networking</span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cudW5hbWUuaW4vNjA=">Vmware Host-Only, NAT, Bridge 차이</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9kaWFybXVpZG1jY2FydGh5LndvcmRwcmVzcy5jb20vMjAxMS8wMi8xNS9oZWxsby13b3JsZC8=">Intro to Virtual Machine Networking</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9yeWFuaXNhZ29vZGd1eS5ibG9nc3BvdC5jb20vMjAxOS8wNi92bXdhcmVuZXR3b3JrLXR5cGVicmlkZ2VkaG9zdC1vbmx5LW5hdC5odG1s">VMware 虛擬機器上網路連線 (Network type) 的三種模式</span></p><h1 id="setp-3网络信息配置"><a class="anchor" href="#setp-3网络信息配置">#</a> setp 3：网络信息配置</h1><p>从上一步可以知道我们目前有两个网络适配器，分别是 NAT 和 桥接模式，然后针对这几个模式的作用也在上面作了介绍了；因此在这里，实际只需要在虚拟机系统中配置桥接模式对应的网卡网络信息就好了；至于 NAT 模式对应的网卡网络信息将由虚拟机借助 NAT （网络地址转换）功能实现自动配置即可实现访问外网功能。</p><ol><li><p>查看所有网卡信息：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td data-command="[root@localhost] $"></td><td><pre><span class="token function">ifconfig</span> <span class="token parameter variable">-a</span></pre></td></tr><tr><td data-num="2"></td><td data-command=""></td><td><pre>ens33: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">416</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>UP,BROADCAST,RUNNING,MULTICAST<span class="token operator">></span>  mtu <span class="token number">1500</span></pre></td></tr><tr><td data-num="3"></td><td data-command=""></td><td><pre>        inet <span class="token number">192.168</span>.154.133  netmask <span class="token number">255.255</span>.255.0  broadcast <span class="token number">192.168</span>.154.255</pre></td></tr><tr><td data-num="4"></td><td data-command=""></td><td><pre>        inet6 fe80::b52c:a0e6:1419:116b  prefixlen <span class="token number">64</span>  scopeid 0x2<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>link<span class="token operator">></span></pre></td></tr><tr><td data-num="5"></td><td data-command=""></td><td><pre>        ether 00:0c:29:f0:76:35  txqueuelen <span class="token number">1000</span>  <span class="token punctuation">(</span>以太网<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td data-command=""></td><td><pre>        RX packets <span class="token number">102259</span>  bytes <span class="token number">150687397</span> <span class="token punctuation">(</span><span class="token number">150.6</span> MB<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td data-command=""></td><td><pre>        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span></pre></td></tr><tr><td data-num="8"></td><td data-command=""></td><td><pre>        TX packets <span class="token number">13950</span>  bytes <span class="token number">938511</span> <span class="token punctuation">(</span><span class="token number">938.5</span> KB<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td data-command=""></td><td><pre>        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span></pre></td></tr><tr><td data-num="10"></td><td data-command=""></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td data-command=""></td><td><pre>ens36: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">416</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>UP,BROADCAST,RUNNING,MULTICAST<span class="token operator">></span>  mtu <span class="token number">1500</span></pre></td></tr><tr><td data-num="12"></td><td data-command=""></td><td><pre>        inet <span class="token number">192.168</span>.17.218  netmask <span class="token number">255.255</span>.255.0  broadcast <span class="token number">192.168</span>.17.255</pre></td></tr><tr><td data-num="13"></td><td data-command=""></td><td><pre>        inet6 240e:47c:680:2899:56c0:dff:d5fe:b1aa  prefixlen <span class="token number">64</span>  scopeid 0x<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>global<span class="token operator">></span></pre></td></tr><tr><td data-num="14"></td><td data-command=""></td><td><pre>        inet6 240e:47c:680:2899:18e7:3cfa:5fad:bbe  prefixlen <span class="token number">64</span>  scopeid 0x<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>global<span class="token operator">></span></pre></td></tr><tr><td data-num="15"></td><td data-command=""></td><td><pre>        inet6 fe80::a25b:a66f:67e7:3e67  prefixlen <span class="token number">64</span>  scopeid 0x2<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>link<span class="token operator">></span></pre></td></tr><tr><td data-num="16"></td><td data-command=""></td><td><pre>        ether 00:0c:29:f0:76:3f  txqueuelen <span class="token number">1000</span>  <span class="token punctuation">(</span>以太网<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td data-command=""></td><td><pre>        RX packets <span class="token number">426</span>  bytes <span class="token number">474569</span> <span class="token punctuation">(</span><span class="token number">474.5</span> KB<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td data-command=""></td><td><pre>        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span></pre></td></tr><tr><td data-num="19"></td><td data-command=""></td><td><pre>        TX packets <span class="token number">403</span>  bytes <span class="token number">44762</span> <span class="token punctuation">(</span><span class="token number">44.7</span> KB<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td data-command=""></td><td><pre>        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span></pre></td></tr><tr><td data-num="21"></td><td data-command=""></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td data-command=""></td><td><pre>lo: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">7</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>UP,LOOPBACK,RUNNING<span class="token operator">></span>  mtu <span class="token number">65536</span></pre></td></tr><tr><td data-num="23"></td><td data-command=""></td><td><pre>        inet <span class="token number">127.0</span>.0.1  netmask <span class="token number">255.0</span>.0.0</pre></td></tr><tr><td data-num="24"></td><td data-command=""></td><td><pre>        inet6 ::1  prefixlen <span class="token number">128</span>  scopeid 0x1<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>host<span class="token operator">></span></pre></td></tr><tr><td data-num="25"></td><td data-command=""></td><td><pre>        loop  txqueuelen <span class="token number">1000</span>  <span class="token punctuation">(</span>本地环回<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td data-command=""></td><td><pre>        RX packets <span class="token number">308</span>  bytes <span class="token number">26853</span> <span class="token punctuation">(</span><span class="token number">26.8</span> KB<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td data-command=""></td><td><pre>        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span></pre></td></tr><tr><td data-num="28"></td><td data-command=""></td><td><pre>        TX packets <span class="token number">308</span>  bytes <span class="token number">26853</span> <span class="token punctuation">(</span><span class="token number">26.8</span> KB<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td data-command=""></td><td><pre>        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span></pre></td></tr></table></figure></li><li><p>启用网卡（如已启用则跳过该步骤），其中 <code>ens36</code> 是设置 bridged 模式的网卡。</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td data-command="[root@localhost] $"></td><td><pre><span class="token function">sudo</span> <span class="token function">ifconfig</span> ens36 up</pre></td></tr></table></figure></li><li><p>修改网络信息配置</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td data-command="[root@localhost] $"></td><td><pre><span class="token function">cp</span> /etc/netplan/01-network-manager-all.yaml /etc/netplan/01-network-manager-all.yaml.back <span class="token comment"># 备份</span></pre></td></tr><tr><td data-num="2"></td><td data-command="[root@localhost] $"></td><td><pre><span class="token function">vim</span> /etc/netplan/01-network-manager-all.yaml</pre></td></tr><tr><td data-num="3"></td><td data-command=""></td><td><pre><span class="token comment"># Let NetworkManager manage all devices on this system</span></pre></td></tr><tr><td data-num="4"></td><td data-command=""></td><td><pre>network:</pre></td></tr><tr><td data-num="5"></td><td data-command=""></td><td><pre>  ethernets:</pre></td></tr><tr><td data-num="6"></td><td data-command=""></td><td><pre>    ens33:</pre></td></tr><tr><td data-num="7"></td><td data-command=""></td><td><pre>      dhcp4: <span class="token boolean">true</span></pre></td></tr><tr><td data-num="8"></td><td data-command=""></td><td><pre>      dhcp4-overrides:</pre></td></tr><tr><td data-num="9"></td><td data-command=""></td><td><pre>        route-metric: <span class="token number">100</span></pre></td></tr><tr><td data-num="10"></td><td data-command=""></td><td><pre>      <span class="token comment"># addresses: [192.168.1.110/24]</span></pre></td></tr><tr><td data-num="11"></td><td data-command=""></td><td><pre>      <span class="token comment"># gateway4: 192.168.1.1</span></pre></td></tr><tr><td data-num="12"></td><td data-command=""></td><td><pre>      <span class="token comment"># nameservers:</span></pre></td></tr><tr><td data-num="13"></td><td data-command=""></td><td><pre>       <span class="token comment"># addresses: [192.168.1.1]</span></pre></td></tr><tr><td data-num="14"></td><td data-command=""></td><td><pre>    ens36:</pre></td></tr><tr><td data-num="15"></td><td data-command=""></td><td><pre>      dhcp4: <span class="token boolean">true</span></pre></td></tr><tr><td data-num="16"></td><td data-command=""></td><td><pre>  version: <span class="token number">2</span></pre></td></tr><tr><td data-num="17"></td><td data-command=""></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td data-command=""></td><td><pre>  bridges:</pre></td></tr><tr><td data-num="19"></td><td data-command=""></td><td><pre>    br0:</pre></td></tr><tr><td data-num="20"></td><td data-command=""></td><td><pre>     interfaces: <span class="token punctuation">[</span>ens36<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="21"></td><td data-command=""></td><td><pre>     dhcp4: no</pre></td></tr><tr><td data-num="22"></td><td data-command=""></td><td><pre>     addresses:</pre></td></tr><tr><td data-num="23"></td><td data-command=""></td><td><pre>      - <span class="token number">192.168</span>.1.110/24</pre></td></tr><tr><td data-num="24"></td><td data-command=""></td><td><pre>     nameservers:</pre></td></tr><tr><td data-num="25"></td><td data-command=""></td><td><pre>       addresses: <span class="token punctuation">[</span><span class="token number">8.8</span>.8.8<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="26"></td><td data-command=""></td><td><pre>     routes:</pre></td></tr><tr><td data-num="27"></td><td data-command=""></td><td><pre>      - to: <span class="token number">0.0</span>.0.0/0</pre></td></tr><tr><td data-num="28"></td><td data-command=""></td><td><pre>        via: <span class="token number">192.168</span>.1.1</pre></td></tr><tr><td data-num="29"></td><td data-command=""></td><td><pre>        metric: <span class="token number">1000</span></pre></td></tr><tr><td data-num="30"></td><td data-command=""></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td data-command=""></td><td><pre><span class="token comment">#  renderer: NetworkManager</span></pre></td></tr><tr><td data-num="32"></td><td data-command=""></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td data-command=""></td><td><pre>netplan apply</pre></td></tr><tr><td data-num="34"></td><td data-command=""></td><td><pre><span class="token function">reboot</span></pre></td></tr></table></figure></li><li><p>重启后查看验证网路</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td data-command="[root@localhost] $"></td><td><pre>route <span class="token parameter variable">-n</span></pre></td></tr><tr><td data-num="2"></td><td data-command=""></td><td><pre>内核 IP 路由表</pre></td></tr><tr><td data-num="3"></td><td data-command=""></td><td><pre>目标            网关            子网掩码        标志  跃点   引用  使用 接口</pre></td></tr><tr><td data-num="4"></td><td data-command=""></td><td><pre><span class="token number">0.0</span>.0.0         <span class="token number">192.168</span>.154.2   <span class="token number">0.0</span>.0.0         UG    <span class="token number">100</span>    <span class="token number">0</span>        <span class="token number">0</span> ens33</pre></td></tr><tr><td data-num="5"></td><td data-command=""></td><td><pre><span class="token number">0.0</span>.0.0         <span class="token number">192.168</span>.1.1     <span class="token number">0.0</span>.0.0         UG    <span class="token number">1000</span>   <span class="token number">0</span>        <span class="token number">0</span> br0</pre></td></tr><tr><td data-num="6"></td><td data-command=""></td><td><pre><span class="token number">192.168</span>.1.0     <span class="token number">0.0</span>.0.0         <span class="token number">255.255</span>.255.0   U     <span class="token number">0</span>      <span class="token number">0</span>        <span class="token number">0</span> br0</pre></td></tr><tr><td data-num="7"></td><td data-command=""></td><td><pre><span class="token number">192.168</span>.154.0   <span class="token number">0.0</span>.0.0         <span class="token number">255.255</span>.255.0   U     <span class="token number">0</span>      <span class="token number">0</span>        <span class="token number">0</span> ens33</pre></td></tr><tr><td data-num="8"></td><td data-command=""></td><td><pre><span class="token number">192.168</span>.154.2   <span class="token number">0.0</span>.0.0         <span class="token number">255.255</span>.255.255 UH    <span class="token number">100</span>    <span class="token number">0</span>        <span class="token number">0</span> ens33</pre></td></tr><tr><td data-num="9"></td><td data-command="[root@localhost] $"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td data-command="[root@localhost] $"></td><td><pre><span class="token function">ping</span> baidu.com</pre></td></tr><tr><td data-num="11"></td><td data-command=""></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="12"></td><td data-command="[root@localhost] $"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td data-command="[root@localhost] $"></td><td><pre><span class="token function">ping</span> <span class="token function">host</span> <span class="token function">ip</span></pre></td></tr><tr><td data-num="14"></td><td data-command=""></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr></table></figure></li></ol><h1 id="关于双网卡无法上网问题"><a class="anchor" href="#关于双网卡无法上网问题">#</a> 关于双网卡无法上网问题</h1><p>当在虚拟机网络中设置完 VMnet0 桥接的 IP 地址等信息，打开网络后，发现网络不通。</p><p>但如果关闭 VMnet0，只保留 VMnet8，网络又是可行的，由此考虑到可能是网卡优先级的配置问题。</p><p>通过上面可以发现 <code>br0</code> 的跃点比 <code>ens33</code> 的 metric 要高，而 metric 越低，其优先级越高，因此按上面操作来一般没问题的；如果这两个网卡的 metric 值反过来，那么会造成无法上网的问题，因为本身我们的有线网口是没有联网的，但优先级又比联网的网卡优先级高，所以会出现 ping 不通外网的情况。</p><p>假设需要临时调整 ip /gateway/metric 等，可以使用 <code>route</code> 命令，而避免更改网络配置表文件，关于 <code>route</code> 命令使用可看 <a href="http://arachnid.cc/linux-routing-table">Linux 路由表说明</a> 。</p><div class="tags"><a href="/tags/Ubuntu/" rel="tag"><i class="ic i-tag"></i> Ubuntu</a> <a href="/tags/Linux/" rel="tag"><i class="ic i-tag"></i> Linux</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2024-09-01 22:57:55" itemprop="dateModified" datetime="2024-09-01T22:57:55+08:00">2024-09-01</time></span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="virtual-network-setup/" class="item leancloud_visitors" data-flag-title="vmware 下 Ubuntu 双网卡设置" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span id="busuanzi_value_page_pv"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 投喂</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.webp" alt="夏沫の浅雨 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.webp" alt="夏沫の浅雨 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>夏沫の浅雨 <i class="ic i-at"><em>@</em></i>命运转轮</li><li class="link"><strong>本文链接：</strong> <a href="https://arachnid.cc/virtual-network-setup/" title="vmware 下 Ubuntu 双网卡设置">https://arachnid.cc/virtual-network-setup/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/uboot-starting/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;arachnid.cc&#x2F;picture&#x2F;(21).webp" title="uboot 引导启动分析"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i></span><h3>uboot 引导启动分析</h3></a></div><div class="item right"><a href="/mfgtool-is-used/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;arachnid.cc&#x2F;picture&#x2F;(6).webp" title="mfgtool 工具烧写使用"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i></span><h3>mfgtool 工具烧写使用</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#step-1%E6%B7%BB%E5%8A%A0%E7%BD%91%E5%8D%A1"><span class="toc-number">1.</span> <span class="toc-text">step 1：添加网卡</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#setp-2%E9%85%8D%E7%BD%AE%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E5%99%A8"><span class="toc-number">2.</span> <span class="toc-text">setp 2：配置网络设备器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%93%E5%B1%95"><span class="toc-number">2.1.</span> <span class="toc-text">拓展</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#setp-3%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF%E9%85%8D%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text">setp 3：网络信息配置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E5%8F%8C%E7%BD%91%E5%8D%A1%E6%97%A0%E6%B3%95%E4%B8%8A%E7%BD%91%E9%97%AE%E9%A2%98"><span class="toc-number">4.</span> <span class="toc-text">关于双网卡无法上网问题</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="夏沫の浅雨" data-src="/images/avatar.webp"><p class="name" itemprop="name">夏沫の浅雨</p><div class="description" itemprop="description">不曾亏欠，不曾辜负，如此足矣</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">84</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">5</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">24</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0FyYWNobmlkLTk3" title="https:&#x2F;&#x2F;github.com&#x2F;Arachnid-97"><i class="ic i-github"></i></span> <span class="exturl item bilibili" data-url="aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vMjM2MTA4MzU=" title="https:&#x2F;&#x2F;space.bilibili.com&#x2F;23610835"><i class="ic i-bilibili"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友人帐</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-info-circle"></i>关于</a></li><li class="item"><a href="/atom.xml" rel="section"><i class="ic i-rss"></i>RSS</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/uboot-starting/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/mfgtool-is-used/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"></div><span><a href="/gcc-compiler-summary" title="GCC 应用总结">GCC 应用总结<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/makefile-summarize" title="来学点 Makefile">来学点 Makefile<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/RTOS/" title="分类于 FreeRTOS">FreeRTOS</a></div><span><a href="/freertos-config" title="FreeRTOS 篇章之 FreeRTOSConfig.h 分析">FreeRTOS 篇章之 FreeRTOSConfig.h 分析<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/freertos-newlib-coexist" title="关于 FreeRTOS 和 newlib库共存问题">关于 FreeRTOS 和 newlib库共存问题<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/RTOS/" title="分类于 FreeRTOS">FreeRTOS</a></div><span><a href="/freertos-event" title="FreeRTOS 篇章之事件位和事件组">FreeRTOS 篇章之事件位和事件组<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/gcc-compiler-collection" title="GCC 编译器套件说明">GCC 编译器套件说明<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/usart-iic-spi" title="USART、I2C、SPI 通信方式扫盲">USART、I2C、SPI 通信方式扫盲<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/logic-device" title="逻辑门、锁存器和触发器">逻辑门、锁存器和触发器<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/ubuntu-ftp-create" title="Ubuntu 下 FTP 的搭建配置">Ubuntu 下 FTP 的搭建配置<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/cortex-m-abnormal" title="Cortex-M3&#x2F;M4&#x2F;M7 故障异常分析">Cortex-M3/M4/M7 故障异常分析<i class="ic i-link-alt"></i></a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2022 – <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">夏沫の浅雨 @ Arachnid's blog</span></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="count"><span class="icon"><i class="ic i-person"></i> <span id="busuanzi_value_site_uv"></span>人 <span class="post-meta-divider">|</span> <span class="icon"><i class="ic i-eye"></i> <span id="busuanzi_value_site_pv"></span>次 <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">642k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">10:55</span></span></span></div><div class="create_time"><span class="icon"><i class="ic i-clock"></i> <span id="timeDate">正在加载</span> <span id="times">...</span><script>function createtime(){var n=new Date("04/28/2022 15:45:50");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML=" 本站存活 "+dnum+" 天 ",document.getElementById("times").innerHTML=hnum+" 小时 "+mnum+" 分 "+snum+" 秒"}var now=new Date;setInterval("createtime()",250)</script></span></div><div class="powered-by">Powered-by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"virtual-network-setup/",favicon:{show:"ψ(｀∇´)ψ 欢迎回来!",hide:"《原子弹入门及制造》"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',isOutdated:!0,format_year_as_prefix:"{{year}}年",format_month_as_prefix:"{{month}}个月",format_month_as_suffix:"零{{month}}个月",format_day_as_prefix:"{{day}}天",format_day_as_suffix:"零{{day}}天",template:"<div class='note warning'><p><span class='label primary'><strong>文章时效性提示</strong></span><br>这是一篇发布于 <span class='pink'>{{publish}}</span> 前，最后一次更新距今已经 <span class='pink'>{{updated}}</span> 的文章，部分内容可能已经过时，请注意甄别。</p></div>",ignores:[function(a){return a.includes("#")},function(a){return new RegExp(LOCAL.path+"$").test(a)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="/js/combined-file.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->