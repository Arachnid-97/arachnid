{
    "version": "https://jsonfeed.org/version/1",
    "title": "命运转轮 • All posts by \"ubuntu\" tag",
    "description": "不曾亏欠, 不曾辜负, 如此足矣",
    "home_page_url": "https://arachnid.cc",
    "items": [
        {
            "id": "https://arachnid.cc/vmware-space-recycling/",
            "url": "https://arachnid.cc/vmware-space-recycling/",
            "title": "VMware 下 ubuntu 空间回收",
            "date_published": "2024-07-07T07:02:28.000Z",
            "content_html": "<p>方法一：</p>\n<p>通过在  <code>虚拟机设置</code>  中的  <code>硬盘</code>  项，进行  <code>碎片整理</code>  和  <code>压缩</code>  处理。</p>\n<p>方法二：</p>\n<p>清空虚拟机系统的回收站</p>\n<p>在 Ubuntu 下，删除了某些文件，而当准备清空回收站的时候，却发现无法清空，打开回收站，在里面进行文件删除时提示 “Failed to delete the item from the trash”。</p>\n<p>解决方法如下：</p>\n<ol>\n<li>\n<p>打开桌面的主文件夹，按组合键 Ctrl+H（显示隐藏文件），找到以下路径： <code>/home/user/.local/share/Trash</code>  （注：user 是用户名，根据你的用户名而变）。</p>\n</li>\n<li>\n<p>在上面的路径下点击鼠标右键，选择 “在终端中打开”。</p>\n</li>\n<li>\n<p>运行命令  <code>sudo rm -rf *</code>  这时，便可以删除那些平时无法删除的文件。</p>\n</li>\n</ol>\n<p>方法三：</p>\n<p>删除  <code>.cache</code>  等配置文件</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 查看 365 天以上的配置文件：</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">find</span> ~/.cache/ <span class=\"token parameter variable\">-depth</span> <span class=\"token parameter variable\">-type</span> f <span class=\"token parameter variable\">-atime</span> +365</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 确认后可删除</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">find</span> ~/.cache/ <span class=\"token parameter variable\">-type</span> f <span class=\"token parameter variable\">-atime</span> +365 <span class=\"token parameter variable\">-delete</span></pre></td></tr></table></figure><p>方法四：</p>\n<p>清除快照，通过进入  <code>快照管理器</code>  把所有快照删除掉。</p>\n<p><strong>note：</strong></p>\n<p>有时候在删除快照的时候点了取消，这时候会存在残留的情况，可以在关机的情况下，拍摄快照，然后再进行删除，这样系统就会把残留的快照重新整合删除，以达到全部删除的效果。</p>\n<p>方法五：</p>\n<p>在 VMware Workstation 的安装目录下，有一个  <code>vmware-vdiskmanager.exe</code>  程序，在该目录下打开终端，输入：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>vmware-vdiskmanager.exe <span class=\"token parameter variable\">-k</span> <span class=\"token string\">\"vmdk 文件路径\"</span></pre></td></tr></table></figure><p>如果安装虚拟机时选择的是将磁盘存储为多个文件，而非存储为单个文件，则只需选择名为： <code>虚拟机名.vmdk</code>  的那个 vmdk 文件 （文件名不带 s 的那种）</p>\n<p>这样就可以使用  <code>vmware-vdiskmanager.exe</code>  程序对 VM 磁盘文件 vmdk 进行压缩</p>\n<p>执行过程会显示压缩进度，完成后会提示：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Shrink: <span class=\"token number\">100</span>% done.</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Shrink completed successfully.</pre></td></tr></table></figure><p><strong>note：</strong></p>\n<p>虚拟机不能有快照，否则会显示：“为该虚拟机禁用了磁盘压缩。”</p>\n<p>方法六：</p>\n<p>在虚拟机中利用命令来释放磁盘空间。</p>\n<p>搜索查看磁盘挂载点：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> vmware-toolbox-cmd disk list</pre></td></tr></table></figure><p>对  <code>/</code>  分区所在的虚拟硬盘进行清理， <code>/</code>  表示你的磁盘挂载点，可以从上一步 list 列表中取值，不清楚的用户可以直接执行：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> /usr/bin/vmware-toolbox-cmd disk wipe /</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">sudo</span> /usr/bin/vmware-toolbox-cmd disk shrink /</pre></td></tr></table></figure><p>也可以使用如下脚本来收缩所有的挂载磁盘：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token shebang important\">#! /bin/bash</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token assign-left variable\">LOG_FILE</span><span class=\"token operator\">=~</span>/vmdiskshrink.log</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token assign-left variable\">DISK_LIST</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">sudo</span> /usr/bin/vmware-toolbox-cmd disk list<span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"will shrink disk: <span class=\"token entity\" title=\"\\n\">\\n</span>############<span class=\"token entity\" title=\"\\n\">\\n</span><span class=\"token variable\">$&#123;DISK_LIST&#125;</span><span class=\"token entity\" title=\"\\n\">\\n</span>############\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">tee</span> <span class=\"token variable\">$&#123;LOG_FILE&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">mydisk</span> <span class=\"token keyword\">in</span> <span class=\"token variable\">$&#123;DISK_LIST&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">do</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token operator\">!</span> <span class=\"token parameter variable\">-d</span> <span class=\"token variable\">$&#123;mydisk&#125;</span> <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">;</span><span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token builtin class-name\">continue</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">fi</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token builtin class-name\">read</span> <span class=\"token parameter variable\">-t</span> <span class=\"token number\">10</span> <span class=\"token parameter variable\">-p</span> <span class=\"token string\">\"shrink <span class=\"token variable\">$&#123;mydisk&#125;</span> ?&lt;Y/n>\"</span> myselect</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$&#123;myselect<span class=\"token operator\">,,</span>&#125;</span>\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"n\"</span> <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">;</span><span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token builtin class-name\">continue</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">fi</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"start wipe <span class=\"token variable\">$&#123;mydisk&#125;</span>\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">tee</span> <span class=\"token parameter variable\">-a</span> <span class=\"token variable\">$&#123;LOG_FILE&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token function\">sudo</span> /usr/bin/vmware-toolbox-cmd disk wipe <span class=\"token variable\">$&#123;mydisk&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"start shrink <span class=\"token variable\">$&#123;mydisk&#125;</span>\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">tee</span> <span class=\"token parameter variable\">-a</span> <span class=\"token variable\">$&#123;LOG_FILE&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token function\">sudo</span> /usr/bin/vmware-toolbox-cmd disk shrink <span class=\"token variable\">$&#123;mydisk&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">done</span></pre></td></tr></table></figure><p><strong>note：</strong></p>\n<p>虚拟机不能有快照，否则会显示：“为该虚拟机禁用了磁盘压缩。”</p>\n",
            "tags": [
                "Ubuntu"
            ]
        },
        {
            "id": "https://arachnid.cc/virtual-network-setup/",
            "url": "https://arachnid.cc/virtual-network-setup/",
            "title": "vmware 下 Ubuntu 双网卡设置",
            "date_published": "2023-02-25T09:28:19.345Z",
            "content_html": "<blockquote>\n<p>背景：主机电脑通过 WiFi 上网，网口用于跟开发板等设备有线连接；为此需要实现虚拟机内对系统可以进行外网访问网页或下载工具包等（避免切换主机操作），同时具备通过网线访问内网设备机器进行控制调试等操作。</p>\n<p>环境：VMware® Workstation 15 Pro</p>\n<p>平台：Ubuntu 18.04.6</p>\n</blockquote>\n<h1 id=\"step-1添加网卡\"><a class=\"anchor\" href=\"#step-1添加网卡\">#</a> step 1：添加网卡</h1>\n<p>在虚拟机窗口栏，依次点击  <code>编辑</code>  -&gt;  <code>虚拟网络编辑器</code>  ，可以看到原有默认的 VMnet 接口：</p>\n<p><img data-src=\"image-20230225172822709.png\" alt=\"image-20230225172822709\" /></p>\n<p>它们分别对应主机 ip 地址。</p>\n<p>然后我们建立一个桥接模式的 VMnet 虚拟网络，并指定响应网卡（如出现灰屏无法设置，需要<strong>以管理员身份打开</strong> VMware，或在当前窗口点击  <code>更改设置</code>  来赋予权限），然后选择对应需要进行桥接的网卡（即网口网卡）：</p>\n<p><img data-src=\"image-20230225193931835.png\" alt=\"image-20230225193931835\" /></p>\n<h1 id=\"setp-2配置网络设备器\"><a class=\"anchor\" href=\"#setp-2配置网络设备器\">#</a> setp 2：配置网络设备器</h1>\n<p>在 ubuntu 虚拟机右键点击  <code>设置</code>  -&gt;  <code>添加</code>  -&gt;  <code>网络适配器</code>  ，然后指定上面配置为桥接模式的  VMnet 虚拟网络：</p>\n<p><img data-src=\"image-20230225194908857.png\" alt=\"image-20230225194908857\" /></p>\n<h2 id=\"拓展\"><a class=\"anchor\" href=\"#拓展\">#</a> 拓展</h2>\n<p>关于 NAT（网络地址转换模式）、Host-only（主机模式）及 bridged（桥接模式）：</p>\n<p><img data-src=\"Perbedaan-NAT-Bridge-Dan-Host-Only-Di-Vmware-Dan-Virtualbox-1170x731.jpg\" alt=\"Perbedaan NAT Bridge Dan Host Only\" /></p>\n<ul>\n<li>\n<p>NAT 模式：使用 NAT 模式，就是让虚拟机借助 NAT （网络地址转换）功能，通过宿主机器所在的网络来访问外部网络，即：使用 NAT 模式可以实现在虚拟系统里访问互联网。</p>\n<p>优点：是从虚拟机访问外部网络的最简单方法；通常，它会自动设置网络地址转换到虚拟机上，不需要在宿主机器的网络信息上配置或通过访客操作系统上进行配置。</p>\n<p>缺点：就像路由器后面的专用网络一样，虚拟机是不可见的，无法从外部网络访问。</p>\n<p><img data-src=\"Virtual_network_switch_in_nat_mode.png\" alt=\"vmware-network-nat\" /></p>\n</li>\n<li>\n<p>Host-only 模式：构建一个与外界断开连接的内部网络，只允许使用 host-only 方法的虚拟机才能通信，因此无法与外部网络或其他 PC 主机通信，只能相互通信。</p>\n<p>优点：与内部网络一样，其不需要存在物理网络接口，相当于使用 host-only 方法的虚拟机通过双绞线直连形成网络节点进行通讯；由于无法访问外部网络，因此对于安全性来讲，比其余两种相对要高。</p>\n<p>缺点：如其名，无法与主机外部的网络通信，同时外部网络设备也无法与其通讯。</p>\n<p><img data-src=\"Virtual_network_switch_in_host-only_mode.png\" alt=\"vmware-network-hostonly\" /></p>\n</li>\n<li>\n<p>bridged 模式：在这种模式下，虚拟系统就像是局域网中的一台独立的主机，具有自己的 MAC 和 IP 地址；由于虚拟机和宿主机器分配了相同网段的 IP，因此宿主机器和虚拟机被识别为同一级别的物理主机。</p>\n<p>优点：虚拟机就像是一台独立的主机，拥有正常主机的网络功能，可以对外部网络进行访问，而外部网络也可以访问进来。</p>\n<p>缺点：由于外部网络可以访问，其安全性比其余两种相对要低；因与宿主机器平等的存在于网络中，需要进行分配网络地址、子网掩码、网关等操作。</p>\n<p><img data-src=\"Virtual_network_switch_in_bridged_mode.png\" alt=\"vmware-network-bridged\" /></p>\n</li>\n</ul>\n<p>示例：</p>\n<p>一些 VMnet 虚拟机具有特定功能：VMnet0 专用于 bridged 模式，VMnet1 专用于 host-only 模式，而 VMnet8 专用于 NAT 模式；其他的 VMnet2 等，可供虚拟机使用自定义网络模式。如图分析各模式作用：</p>\n<p><img data-src=\"workstation-networking_thumb1.jpg\" alt=\"工作站网络\" /></p>\n<ul>\n<li>\n<p>VM-1 可以与 host PC 通信，并连接到外部 LAN or internet，但不能与 NAT 和 host-only 网络通信。</p>\n</li>\n<li>\n<p>VM-2 和 VM-3 可以相互通信，也可以与 NAT 网络中的其他 VM 通信，也可以与 host PC 通信。</p>\n</li>\n<li>\n<p>VM-5 和 VM-4 可以相互通信，但不能与主机操作系统和 host-only 网络中的其他 VM 通信。</p>\n</li>\n<li>\n<p>VM-6 和 VM-7 无法相互通信。</p>\n</li>\n</ul>\n<p>参考：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zdXBlcnVzZXIuY29tL3F1ZXN0aW9ucy8yMjc1MDUvd2hhdC1pcy10aGUtZGlmZmVyZW5jZS1iZXR3ZWVuLW5hdC1icmlkZ2VkLWhvc3Qtb25seS1uZXR3b3JraW5n\">What is the difference between NAT / Bridged / Host-Only networking?</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9waWJ5dGVzLndvcmRwcmVzcy5jb20vMjAxMi8xMS8xNi92bXdhcmUtd29ya3N0YXRpb24tbmV0d29ya2luZy1iYXNpY3Mv\">VMware Workstation Networking Basics</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9hZ3Vzc2FzLndvcmRwcmVzcy5jb20vMjAxNS8xMC8yOC92bXdhcmUtbmV0d29ya2luZy1jb25jZXB0LWJyaWRnZWQtbmF0LWhvc3Qtb25seS1sYW4tc2VnbWVudC8=\">VMWare Networking Concept [Bridged, NAT, Host Only, LAN Segment]</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubW9uaXRvcnRla25vbG9naS5jb20vcGVyYmVkYWFuLW5hdC1icmlkZ2UtZGFuLWhvc3Qtb25seS8=\">Perbedaan NAT Bridge Dan Host Only Di VMware Dan VirtualBox</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93aWtpLmxpYnZpcnQub3JnL1ZpcnR1YWxOZXR3b3JraW5nLmh0bWw=\">Virtual Networking</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudW5hbWUuaW4vNjA=\">Vmware Host-Only, NAT, Bridge 차이</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kaWFybXVpZG1jY2FydGh5LndvcmRwcmVzcy5jb20vMjAxMS8wMi8xNS9oZWxsby13b3JsZC8=\">Intro to Virtual Machine Networking</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9yeWFuaXNhZ29vZGd1eS5ibG9nc3BvdC5jb20vMjAxOS8wNi92bXdhcmVuZXR3b3JrLXR5cGVicmlkZ2VkaG9zdC1vbmx5LW5hdC5odG1s\">VMware 虛擬機器上網路連線 (Network type) 的三種模式</span></p>\n<h1 id=\"setp-3网络信息配置\"><a class=\"anchor\" href=\"#setp-3网络信息配置\">#</a> setp 3：网络信息配置</h1>\n<p>从上一步可以知道我们目前有两个网络适配器，分别是 NAT 和 桥接模式，然后针对这几个模式的作用也在上面作了介绍了；因此在这里，实际只需要在虚拟机系统中配置桥接模式对应的网卡网络信息就好了；至于 NAT 模式对应的网卡网络信息将由虚拟机借助 NAT （网络地址转换）功能实现自动配置即可实现访问外网功能。</p>\n<ol>\n<li>\n<p>查看所有网卡信息：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">ifconfig</span> <span class=\"token parameter variable\">-a</span></pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"\"></td><td><pre>ens33: <span class=\"token assign-left variable\">flags</span><span class=\"token operator\">=</span><span class=\"token number\">416</span><span class=\"token operator\"><span class=\"token file-descriptor important\">3</span>&lt;</span>UP,BROADCAST,RUNNING,MULTICAST<span class=\"token operator\">></span>  mtu <span class=\"token number\">1500</span></pre></td></tr><tr><td data-num=\"3\"></td><td data-command=\"\"></td><td><pre>        inet <span class=\"token number\">192.168</span>.154.133  netmask <span class=\"token number\">255.255</span>.255.0  broadcast <span class=\"token number\">192.168</span>.154.255</pre></td></tr><tr><td data-num=\"4\"></td><td data-command=\"\"></td><td><pre>        inet6 fe80::b52c:a0e6:1419:116b  prefixlen <span class=\"token number\">64</span>  scopeid 0x2<span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>&lt;</span>link<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"5\"></td><td data-command=\"\"></td><td><pre>        ether 00:0c:29:f0:76:35  txqueuelen <span class=\"token number\">1000</span>  <span class=\"token punctuation\">(</span>以太网<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td data-command=\"\"></td><td><pre>        RX packets <span class=\"token number\">102259</span>  bytes <span class=\"token number\">150687397</span> <span class=\"token punctuation\">(</span><span class=\"token number\">150.6</span> MB<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td data-command=\"\"></td><td><pre>        RX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span>  overruns <span class=\"token number\">0</span>  frame <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"8\"></td><td data-command=\"\"></td><td><pre>        TX packets <span class=\"token number\">13950</span>  bytes <span class=\"token number\">938511</span> <span class=\"token punctuation\">(</span><span class=\"token number\">938.5</span> KB<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td data-command=\"\"></td><td><pre>        TX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span> overruns <span class=\"token number\">0</span>  carrier <span class=\"token number\">0</span>  collisions <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"10\"></td><td data-command=\"\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td data-command=\"\"></td><td><pre>ens36: <span class=\"token assign-left variable\">flags</span><span class=\"token operator\">=</span><span class=\"token number\">416</span><span class=\"token operator\"><span class=\"token file-descriptor important\">3</span>&lt;</span>UP,BROADCAST,RUNNING,MULTICAST<span class=\"token operator\">></span>  mtu <span class=\"token number\">1500</span></pre></td></tr><tr><td data-num=\"12\"></td><td data-command=\"\"></td><td><pre>        inet <span class=\"token number\">192.168</span>.17.218  netmask <span class=\"token number\">255.255</span>.255.0  broadcast <span class=\"token number\">192.168</span>.17.255</pre></td></tr><tr><td data-num=\"13\"></td><td data-command=\"\"></td><td><pre>        inet6 240e:47c:680:2899:56c0:dff:d5fe:b1aa  prefixlen <span class=\"token number\">64</span>  scopeid 0x<span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>&lt;</span>global<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"14\"></td><td data-command=\"\"></td><td><pre>        inet6 240e:47c:680:2899:18e7:3cfa:5fad:bbe  prefixlen <span class=\"token number\">64</span>  scopeid 0x<span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>&lt;</span>global<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"15\"></td><td data-command=\"\"></td><td><pre>        inet6 fe80::a25b:a66f:67e7:3e67  prefixlen <span class=\"token number\">64</span>  scopeid 0x2<span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>&lt;</span>link<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"16\"></td><td data-command=\"\"></td><td><pre>        ether 00:0c:29:f0:76:3f  txqueuelen <span class=\"token number\">1000</span>  <span class=\"token punctuation\">(</span>以太网<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td data-command=\"\"></td><td><pre>        RX packets <span class=\"token number\">426</span>  bytes <span class=\"token number\">474569</span> <span class=\"token punctuation\">(</span><span class=\"token number\">474.5</span> KB<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td data-command=\"\"></td><td><pre>        RX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span>  overruns <span class=\"token number\">0</span>  frame <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"19\"></td><td data-command=\"\"></td><td><pre>        TX packets <span class=\"token number\">403</span>  bytes <span class=\"token number\">44762</span> <span class=\"token punctuation\">(</span><span class=\"token number\">44.7</span> KB<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td data-command=\"\"></td><td><pre>        TX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span> overruns <span class=\"token number\">0</span>  carrier <span class=\"token number\">0</span>  collisions <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"21\"></td><td data-command=\"\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td data-command=\"\"></td><td><pre>lo: <span class=\"token assign-left variable\">flags</span><span class=\"token operator\">=</span><span class=\"token number\">7</span><span class=\"token operator\"><span class=\"token file-descriptor important\">3</span>&lt;</span>UP,LOOPBACK,RUNNING<span class=\"token operator\">></span>  mtu <span class=\"token number\">65536</span></pre></td></tr><tr><td data-num=\"23\"></td><td data-command=\"\"></td><td><pre>        inet <span class=\"token number\">127.0</span>.0.1  netmask <span class=\"token number\">255.0</span>.0.0</pre></td></tr><tr><td data-num=\"24\"></td><td data-command=\"\"></td><td><pre>        inet6 ::1  prefixlen <span class=\"token number\">128</span>  scopeid 0x1<span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>&lt;</span>host<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"25\"></td><td data-command=\"\"></td><td><pre>        loop  txqueuelen <span class=\"token number\">1000</span>  <span class=\"token punctuation\">(</span>本地环回<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td data-command=\"\"></td><td><pre>        RX packets <span class=\"token number\">308</span>  bytes <span class=\"token number\">26853</span> <span class=\"token punctuation\">(</span><span class=\"token number\">26.8</span> KB<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td data-command=\"\"></td><td><pre>        RX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span>  overruns <span class=\"token number\">0</span>  frame <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"28\"></td><td data-command=\"\"></td><td><pre>        TX packets <span class=\"token number\">308</span>  bytes <span class=\"token number\">26853</span> <span class=\"token punctuation\">(</span><span class=\"token number\">26.8</span> KB<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td data-command=\"\"></td><td><pre>        TX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span> overruns <span class=\"token number\">0</span>  carrier <span class=\"token number\">0</span>  collisions <span class=\"token number\">0</span></pre></td></tr></table></figure></li>\n<li>\n<p>启用网卡（如已启用则跳过该步骤），其中  <code>ens36</code>  是设置 bridged 模式的网卡。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">ifconfig</span> ens36 up</pre></td></tr></table></figure></li>\n<li>\n<p>修改网络信息配置</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">cp</span> /etc/netplan/01-network-manager-all.yaml /etc/netplan/01-network-manager-all.yaml.back <span class=\"token comment\"># 备份</span></pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> /etc/netplan/01-network-manager-all.yaml</pre></td></tr><tr><td data-num=\"3\"></td><td data-command=\"\"></td><td><pre><span class=\"token comment\"># Let NetworkManager manage all devices on this system</span></pre></td></tr><tr><td data-num=\"4\"></td><td data-command=\"\"></td><td><pre>network:</pre></td></tr><tr><td data-num=\"5\"></td><td data-command=\"\"></td><td><pre>  ethernets:</pre></td></tr><tr><td data-num=\"6\"></td><td data-command=\"\"></td><td><pre>    ens33:</pre></td></tr><tr><td data-num=\"7\"></td><td data-command=\"\"></td><td><pre>      dhcp4: <span class=\"token boolean\">true</span></pre></td></tr><tr><td data-num=\"8\"></td><td data-command=\"\"></td><td><pre>      dhcp4-overrides:</pre></td></tr><tr><td data-num=\"9\"></td><td data-command=\"\"></td><td><pre>        route-metric: <span class=\"token number\">100</span></pre></td></tr><tr><td data-num=\"10\"></td><td data-command=\"\"></td><td><pre>      <span class=\"token comment\"># addresses: [192.168.1.110/24]</span></pre></td></tr><tr><td data-num=\"11\"></td><td data-command=\"\"></td><td><pre>      <span class=\"token comment\"># gateway4: 192.168.1.1</span></pre></td></tr><tr><td data-num=\"12\"></td><td data-command=\"\"></td><td><pre>      <span class=\"token comment\"># nameservers:</span></pre></td></tr><tr><td data-num=\"13\"></td><td data-command=\"\"></td><td><pre>       <span class=\"token comment\"># addresses: [192.168.1.1]</span></pre></td></tr><tr><td data-num=\"14\"></td><td data-command=\"\"></td><td><pre>    ens36:</pre></td></tr><tr><td data-num=\"15\"></td><td data-command=\"\"></td><td><pre>      dhcp4: <span class=\"token boolean\">true</span></pre></td></tr><tr><td data-num=\"16\"></td><td data-command=\"\"></td><td><pre>  version: <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"17\"></td><td data-command=\"\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td data-command=\"\"></td><td><pre>  bridges:</pre></td></tr><tr><td data-num=\"19\"></td><td data-command=\"\"></td><td><pre>    br0:</pre></td></tr><tr><td data-num=\"20\"></td><td data-command=\"\"></td><td><pre>     interfaces: <span class=\"token punctuation\">[</span>ens36<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"21\"></td><td data-command=\"\"></td><td><pre>     dhcp4: no</pre></td></tr><tr><td data-num=\"22\"></td><td data-command=\"\"></td><td><pre>     addresses:</pre></td></tr><tr><td data-num=\"23\"></td><td data-command=\"\"></td><td><pre>      - <span class=\"token number\">192.168</span>.1.110/24</pre></td></tr><tr><td data-num=\"24\"></td><td data-command=\"\"></td><td><pre>     nameservers:</pre></td></tr><tr><td data-num=\"25\"></td><td data-command=\"\"></td><td><pre>       addresses: <span class=\"token punctuation\">[</span><span class=\"token number\">8.8</span>.8.8<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td data-command=\"\"></td><td><pre>     routes:</pre></td></tr><tr><td data-num=\"27\"></td><td data-command=\"\"></td><td><pre>      - to: <span class=\"token number\">0.0</span>.0.0/0</pre></td></tr><tr><td data-num=\"28\"></td><td data-command=\"\"></td><td><pre>        via: <span class=\"token number\">192.168</span>.1.1</pre></td></tr><tr><td data-num=\"29\"></td><td data-command=\"\"></td><td><pre>        metric: <span class=\"token number\">1000</span></pre></td></tr><tr><td data-num=\"30\"></td><td data-command=\"\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td data-command=\"\"></td><td><pre><span class=\"token comment\">#  renderer: NetworkManager</span></pre></td></tr><tr><td data-num=\"32\"></td><td data-command=\"\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td data-command=\"\"></td><td><pre>netplan apply</pre></td></tr><tr><td data-num=\"34\"></td><td data-command=\"\"></td><td><pre><span class=\"token function\">reboot</span></pre></td></tr></table></figure></li>\n<li>\n<p>重启后查看验证网路</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre>route <span class=\"token parameter variable\">-n</span></pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"\"></td><td><pre>内核 IP 路由表</pre></td></tr><tr><td data-num=\"3\"></td><td data-command=\"\"></td><td><pre>目标            网关            子网掩码        标志  跃点   引用  使用 接口</pre></td></tr><tr><td data-num=\"4\"></td><td data-command=\"\"></td><td><pre><span class=\"token number\">0.0</span>.0.0         <span class=\"token number\">192.168</span>.154.2   <span class=\"token number\">0.0</span>.0.0         UG    <span class=\"token number\">100</span>    <span class=\"token number\">0</span>        <span class=\"token number\">0</span> ens33</pre></td></tr><tr><td data-num=\"5\"></td><td data-command=\"\"></td><td><pre><span class=\"token number\">0.0</span>.0.0         <span class=\"token number\">192.168</span>.1.1     <span class=\"token number\">0.0</span>.0.0         UG    <span class=\"token number\">1000</span>   <span class=\"token number\">0</span>        <span class=\"token number\">0</span> br0</pre></td></tr><tr><td data-num=\"6\"></td><td data-command=\"\"></td><td><pre><span class=\"token number\">192.168</span>.1.0     <span class=\"token number\">0.0</span>.0.0         <span class=\"token number\">255.255</span>.255.0   U     <span class=\"token number\">0</span>      <span class=\"token number\">0</span>        <span class=\"token number\">0</span> br0</pre></td></tr><tr><td data-num=\"7\"></td><td data-command=\"\"></td><td><pre><span class=\"token number\">192.168</span>.154.0   <span class=\"token number\">0.0</span>.0.0         <span class=\"token number\">255.255</span>.255.0   U     <span class=\"token number\">0</span>      <span class=\"token number\">0</span>        <span class=\"token number\">0</span> ens33</pre></td></tr><tr><td data-num=\"8\"></td><td data-command=\"\"></td><td><pre><span class=\"token number\">192.168</span>.154.2   <span class=\"token number\">0.0</span>.0.0         <span class=\"token number\">255.255</span>.255.255 UH    <span class=\"token number\">100</span>    <span class=\"token number\">0</span>        <span class=\"token number\">0</span> ens33</pre></td></tr><tr><td data-num=\"9\"></td><td data-command=\"[root@localhost] $\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">ping</span> baidu.com</pre></td></tr><tr><td data-num=\"11\"></td><td data-command=\"\"></td><td><pre><span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"12\"></td><td data-command=\"[root@localhost] $\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">ping</span> <span class=\"token function\">host</span> <span class=\"token function\">ip</span></pre></td></tr><tr><td data-num=\"14\"></td><td data-command=\"\"></td><td><pre><span class=\"token punctuation\">..</span>.</pre></td></tr></table></figure></li>\n</ol>\n<h1 id=\"关于双网卡无法上网问题\"><a class=\"anchor\" href=\"#关于双网卡无法上网问题\">#</a> 关于双网卡无法上网问题</h1>\n<p>当在虚拟机网络中设置完 VMnet0 桥接的 IP 地址等信息，打开网络后，发现网络不通。</p>\n<p>但如果关闭 VMnet0，只保留 VMnet8，网络又是可行的，由此考虑到可能是网卡优先级的配置问题。</p>\n<p>通过上面可以发现  <code>br0</code>  的跃点比  <code>ens33</code>  的 metric 要高，而 metric 越低，其优先级越高，因此按上面操作来一般没问题的；如果这两个网卡的 metric 值反过来，那么会造成无法上网的问题，因为本身我们的有线网口是没有联网的，但优先级又比联网的网卡优先级高，所以会出现 ping 不通外网的情况。</p>\n<p>假设需要临时调整 ip /gateway/metric 等，可以使用  <code>route</code>  命令，而避免更改网络配置表文件，关于  <code>route</code>  命令使用可看 <a href=\"http://arachnid.cc/linux-routing-table\">Linux 路由表说明</a> 。</p>\n",
            "tags": [
                "Ubuntu",
                "Linux"
            ]
        },
        {
            "id": "https://arachnid.cc/ubuntu-tftp-nfs-create/",
            "url": "https://arachnid.cc/ubuntu-tftp-nfs-create/",
            "title": "Ubuntu 搭建 tftp 及 NFS 服务",
            "date_published": "2022-12-13T14:56:07.000Z",
            "content_html": "<blockquote>\n<p>平台：Ubuntu 18.04.6</p>\n</blockquote>\n<h1 id=\"tftp-服务端搭建\"><a class=\"anchor\" href=\"#tftp-服务端搭建\">#</a> tftp 服务端搭建</h1>\n<h2 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> 安装</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> update</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> tftpd-hpa</pre></td></tr></table></figure><h2 id=\"配置\"><a class=\"anchor\" href=\"#配置\">#</a> 配置</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">mkdir</span> /home/user/tftp_share</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">chmod</span> <span class=\"token parameter variable\">-R</span> <span class=\"token number\">777</span> /home/user/tftp_share</pre></td></tr><tr><td data-num=\"3\"></td><td data-command=\"[user@localhost] #\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">vim</span> /etc/default/tftpd-hpa</pre></td></tr></table></figure><p>更改  <code>TFTP_DIRECTORY</code>  字段，填写配置 tftp 服务共享的路径，eg：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>TFTP_USERNAME=\"tftp\"</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>TFTP_DIRECTORY=\"/home/user/tftp_share\"</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>TFTP_ADDRESS=\":69\"</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>TFTP_OPTIONS=\"-l -c -s\"</pre></td></tr></table></figure><h2 id=\"启动服务\"><a class=\"anchor\" href=\"#启动服务\">#</a> 启动服务</h2>\n<p>在加载完后，重启服务器：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> systemctl restart tftpd-hpa</pre></td></tr></table></figure><p>查看服务启动状态：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> systemctl status tftpd-hpa</pre></td></tr></table></figure><h2 id=\"测试传输\"><a class=\"anchor\" href=\"#测试传输\">#</a> 测试传输</h2>\n<p>如果本机没有安装 tftp 客户端，可以使用以下命令安装：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> update</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> tftp-hpa</pre></td></tr></table></figure><p>然后连接 tftp 服务器，通过 get 和 put 读写文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre>tftp <span class=\"token number\">127.0</span>.0.1 <span class=\"token comment\">#连接服务器</span></pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"\"></td><td><pre><span class=\"token operator\">></span> get a.txt <span class=\"token comment\"># 获取 a.txt</span></pre></td></tr><tr><td data-num=\"3\"></td><td data-command=\"\"></td><td><pre><span class=\"token operator\">></span> put b.txt <span class=\"token comment\"># 上传 b.txt</span></pre></td></tr><tr><td data-num=\"4\"></td><td data-command=\"\"></td><td><pre><span class=\"token operator\">></span> q <span class=\"token comment\"># 断开连接</span></pre></td></tr></table></figure><h1 id=\"nfs-服务端搭建\"><a class=\"anchor\" href=\"#nfs-服务端搭建\">#</a> NFS 服务端搭建</h1>\n<h2 id=\"安装-2\"><a class=\"anchor\" href=\"#安装-2\">#</a> 安装</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> update</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> nfs-kernel-server</pre></td></tr></table></figure><h2 id=\"配置-2\"><a class=\"anchor\" href=\"#配置-2\">#</a> 配置</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">mkdir</span> /home/user/nfs_share</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">chmod</span> <span class=\"token parameter variable\">-R</span> <span class=\"token number\">777</span> /home/user/nfs_share</pre></td></tr><tr><td data-num=\"3\"></td><td data-command=\"[user@localhost] #\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">vim</span> /etc/exports</pre></td></tr></table></figure><p>在最后一行添加自己的共享路径，如：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/home/user/nfs_share *(rw,sync,no_root_squash,no_subtree_check)</pre></td></tr></table></figure><p><strong>note：</strong></p>\n<p><code>/home/nfs_share</code>  是 NFS 服务端的共享路径。</p>\n<p><code>*</code>  表示所有网段都可以访问（可以指定具体的 ip ）。</p>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>ro</code></td>\n<td>只读访问</td>\n</tr>\n<tr>\n<td><code>rw</code></td>\n<td>读写访问</td>\n</tr>\n<tr>\n<td><code>sync</code></td>\n<td>所有数据在请求时写入共享</td>\n</tr>\n<tr>\n<td><code>async</code></td>\n<td>nfs 在写入数据前可以响应请求</td>\n</tr>\n<tr>\n<td><code>secure</code></td>\n<td>nfs 通过 1024 以下的安全 TCP/IP 端口发送</td>\n</tr>\n<tr>\n<td><code>insecure</code></td>\n<td>nfs 通过 1024 以上的端口发送</td>\n</tr>\n<tr>\n<td><code>wdelay</code></td>\n<td>如果多个用户要写入 nfs 目录，则归组写入（默认）</td>\n</tr>\n<tr>\n<td><code>no_wdelay</code></td>\n<td>如果多个用户要写入 nfs 目录，则立即写入，当使用 async 时，无需此设置</td>\n</tr>\n<tr>\n<td><code>hide</code></td>\n<td>在 nfs 共享目录中不共享其子目录</td>\n</tr>\n<tr>\n<td><code>no_hide</code></td>\n<td>共享 nfs 目录的子目录</td>\n</tr>\n<tr>\n<td><code>subtree_check</code></td>\n<td>如果共享 /usr/bin 之类的子目录时，强制 nfs 检查父目录的权限（默认）</td>\n</tr>\n<tr>\n<td><code>no_subtree_check</code></td>\n<td>不检查父目录权限</td>\n</tr>\n<tr>\n<td><code>all_squash</code></td>\n<td>共享文件的 UID 和 GID 映射匿名用户 anonymous，适合公用目录</td>\n</tr>\n<tr>\n<td><code>no_all_squash</code></td>\n<td>保留共享文件的 UID 和 GID（默认）</td>\n</tr>\n<tr>\n<td><code>root_squash</code></td>\n<td>root 用户的所有请求映射成如 anonymous 用户一样的权限（默认）</td>\n</tr>\n<tr>\n<td><code>no_root_squash</code></td>\n<td>root 用户具有根目录的完全管理访问权限</td>\n</tr>\n<tr>\n<td><code>anonuid=xxx</code></td>\n<td>指定 nfs 服务器 /etc/passwd 文件中匿名用户的 UID</td>\n</tr>\n<tr>\n<td><code>anongid=xxx</code></td>\n<td>指定 nfs 服务器 /etc/passwd 文件中匿名用户的 GID</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"启动服务-2\"><a class=\"anchor\" href=\"#启动服务-2\">#</a> 启动服务</h2>\n<p>在加载完后，重启服务器：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> systemctl restart nfs-kernel-server</pre></td></tr></table></figure><p>查看服务启动状态：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> systemctl status nfs-kernel-server</pre></td></tr></table></figure><h2 id=\"测试挂载\"><a class=\"anchor\" href=\"#测试挂载\">#</a> 测试挂载</h2>\n<p>如果本机没有安装 NFS 客户端，可以使用以下命令安装：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> update</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> nfs-common</pre></td></tr></table></figure><p>然后执行本地挂载测试：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">mount</span> <span class=\"token parameter variable\">-t</span> nfs <span class=\"token parameter variable\">-o</span> nolock localhost:/home/user/nfs_share /mnt</pre></td></tr></table></figure><h2 id=\"添加对-version-2-的支持\"><a class=\"anchor\" href=\"#添加对-version-2-的支持\">#</a> 添加对 version 2 的支持</h2>\n<p>使用如下命令查看对 NFS 版本的支持：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">cat</span> /proc/fs/nfsd/versions</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"\"></td><td><pre><span class=\"token parameter variable\">-2</span> +3 +4 +4.1 +4.2</pre></td></tr></table></figure><p>可以看出来  <code>-2</code>  说明目前是对 NFS 的 version 2 并不支持的，因此需要稍作修改才可完成兼容工作：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">vim</span> /etc/default/nfs-kernel-server</pre></td></tr></table></figure><p>通过修改  <code>RPCNFSDCOUNT</code>  、 <code>RPCMOUNTDOPTS</code>  、 <code>RPCSVCGSSDOPTS</code>  的字段得到：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># Number of servers to start up</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>RPCNFSDCOUNT=\"-V 2 8\"</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre># Runtime priority of server (see nice(1))</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>RPCNFSDPRIORITY=0</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre># Options for rpc.mountd.</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># If you have a port-based firewall, you might want to set up</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># a fixed port here using the --port option. For more information, </pre></td></tr><tr><td data-num=\"10\"></td><td><pre># see rpc.mountd(8) or http://wiki.debian.org/SecuringNFS</pre></td></tr><tr><td data-num=\"11\"></td><td><pre># To disable NFSv4 on the server, specify '--no-nfs-version 4' here</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>RPCMOUNTDOPTS=\"-V 2 --manage-gids\"</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre># Do you want to start the svcgssd daemon? It is only required for Kerberos</pre></td></tr><tr><td data-num=\"15\"></td><td><pre># exports. Valid alternatives are \"yes\" and \"no\"; the default is \"no\".</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>NEED_SVCGSSD=\"\"</pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre># Options for rpc.svcgssd.</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>RPCSVCGSSDOPTS=\"--nfs-version 2,3,4 --debug --syslog\"</pre></td></tr></table></figure><p>然后重启一下服务，再次查看版本支持：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> systemctl restart nfs-kernel-server</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">cat</span> /proc/fs/nfsd/versions</pre></td></tr><tr><td data-num=\"3\"></td><td data-command=\"\"></td><td><pre>+2 +3 +4 +4.1 +4.2</pre></td></tr></table></figure>",
            "tags": [
                "history",
                "Ubuntu",
                "Linux"
            ]
        },
        {
            "id": "https://arachnid.cc/ubuntu-ftp-create/",
            "url": "https://arachnid.cc/ubuntu-ftp-create/",
            "title": "Ubuntu 下 FTP 的搭建配置",
            "date_published": "2022-11-03T13:13:57.653Z",
            "content_html": "<blockquote>\n<p>平台：Ubuntu 18.04.6</p>\n<p>vsftpd 官网：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zZWN1cml0eS5hcHBzcG90LmNvbS92c2Z0cGQuaHRtbA==\">https://security.appspot.com/vsftpd.html</span></p>\n</blockquote>\n<h1 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> 安装</h1>\n<p>安装 FTP 服务，命令行输入：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> update</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> vsftpd</pre></td></tr></table></figure><h1 id=\"配置\"><a class=\"anchor\" href=\"#配置\">#</a> 配置</h1>\n<p>先备份配置文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> /etc/vsftpd.conf /etc/vsftpd.conf.back</pre></td></tr></table></figure><p>vim 进入编辑信息：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">vim</span> /etc/vsftpd.conf</pre></td></tr></table></figure><p>然后增加或修改以下信息：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># Example config file /etc/vsftpd.conf</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>#</pre></td></tr><tr><td data-num=\"3\"></td><td><pre># The default compiled in settings are fairly paranoid. This sample file</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># loosens things up a bit, to make the ftp daemon more usable.</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># Please see vsftpd.conf.5 for all compiled in defaults.</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>#</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># READ THIS: This example file is NOT an exhaustive list of vsftpd options.</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># Please read the vsftpd.conf.5 manual page to get a full idea of vsftpd's</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># capabilities.</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>#</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>#</pre></td></tr><tr><td data-num=\"12\"></td><td><pre># Run standalone?  vsftpd can run either from an inetd or as a standalone</pre></td></tr><tr><td data-num=\"13\"></td><td><pre># daemon started from an initscript.</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>listen=NO #是否开启侦听状态</pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre># This directive enables listening on IPv6 sockets. By default, listening</pre></td></tr><tr><td data-num=\"17\"></td><td><pre># on the IPv6 \"any\" address (::) will accept connections from both IPv6</pre></td></tr><tr><td data-num=\"18\"></td><td><pre># and IPv4 clients. It is not necessary to listen on *both* IPv4 and IPv6</pre></td></tr><tr><td data-num=\"19\"></td><td><pre># sockets. If you want that (perhaps because you want to listen on specific</pre></td></tr><tr><td data-num=\"20\"></td><td><pre># addresses) then you must run two copies of vsftpd with two configuration</pre></td></tr><tr><td data-num=\"21\"></td><td><pre># files.</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>listen_ipv6=YES #如果能使用 ipv6的可以打开使用；只能用 ipv4的必须注释掉，不然重启不了</pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre># Allow anonymous FTP? (Disabled by default).</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>anonymous_enable=YES #允许匿名用户登录</pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre># Uncomment this to allow local users to log in.</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>local_enable=YES #允许实名登录</pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre># Uncomment this to enable any form of FTP write command.</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>write_enable=YES #允许实名用户进行写操作</pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre># Default umask for local users is 077. You may wish to change this to 022,</pre></td></tr><tr><td data-num=\"34\"></td><td><pre># if your users expect that (022 is used by most other ftpd's)</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>#local_umask=022</pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre># Uncomment this to allow the anonymous FTP user to upload files. This only</pre></td></tr><tr><td data-num=\"38\"></td><td><pre># has an effect if the above global write enable is activated. Also, you will</pre></td></tr><tr><td data-num=\"39\"></td><td><pre># obviously need to create a directory writable by the FTP user.</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>anon_upload_enable=YES #允许匿名用户上传文件</pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre># Uncomment this if you want the anonymous FTP user to be able to create</pre></td></tr><tr><td data-num=\"43\"></td><td><pre># new directories.</pre></td></tr><tr><td data-num=\"44\"></td><td><pre>anon_mkdir_write_enable=YES #允许匿名用户创建目录</pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre># Activate directory messages - messages given to remote users when they</pre></td></tr><tr><td data-num=\"47\"></td><td><pre># go into a certain directory.</pre></td></tr><tr><td data-num=\"48\"></td><td><pre>dirmessage_enable=YES</pre></td></tr><tr><td data-num=\"49\"></td><td><pre></pre></td></tr><tr><td data-num=\"50\"></td><td><pre># If enabled, vsftpd will display directory listings with the time</pre></td></tr><tr><td data-num=\"51\"></td><td><pre># in  your  local  time  zone.  The default is to display GMT. The</pre></td></tr><tr><td data-num=\"52\"></td><td><pre># times returned by the MDTM FTP command are also affected by this</pre></td></tr><tr><td data-num=\"53\"></td><td><pre># option.</pre></td></tr><tr><td data-num=\"54\"></td><td><pre>use_localtime=YES</pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre># Activate logging of uploads/downloads.</pre></td></tr><tr><td data-num=\"57\"></td><td><pre>xferlog_enable=YES</pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre># Make sure PORT transfer connections originate from port 20 (ftp-data).</pre></td></tr><tr><td data-num=\"60\"></td><td><pre>connect_from_port_20=YES</pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre># If you want, you can arrange for uploaded anonymous files to be owned by</pre></td></tr><tr><td data-num=\"63\"></td><td><pre># a different user. Note! Using \"root\" for uploaded files is not</pre></td></tr><tr><td data-num=\"64\"></td><td><pre># recommended!</pre></td></tr><tr><td data-num=\"65\"></td><td><pre>#chown_uploads=YES</pre></td></tr><tr><td data-num=\"66\"></td><td><pre>#chown_username=whoever</pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre># You may override where the log file goes if you like. The default is shown</pre></td></tr><tr><td data-num=\"69\"></td><td><pre># below.</pre></td></tr><tr><td data-num=\"70\"></td><td><pre>#xferlog_file=/var/log/vsftpd.log</pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre># If you want, you can have your log file in standard ftpd xferlog format.</pre></td></tr><tr><td data-num=\"73\"></td><td><pre># Note that the default log file location is /var/log/xferlog in this case.</pre></td></tr><tr><td data-num=\"74\"></td><td><pre>#xferlog_std_format=YES</pre></td></tr><tr><td data-num=\"75\"></td><td><pre></pre></td></tr><tr><td data-num=\"76\"></td><td><pre># You may change the default value for timing out an idle session.</pre></td></tr><tr><td data-num=\"77\"></td><td><pre>#idle_session_timeout=600</pre></td></tr><tr><td data-num=\"78\"></td><td><pre></pre></td></tr><tr><td data-num=\"79\"></td><td><pre># You may change the default value for timing out a data connection.</pre></td></tr><tr><td data-num=\"80\"></td><td><pre>#data_connection_timeout=120</pre></td></tr><tr><td data-num=\"81\"></td><td><pre></pre></td></tr><tr><td data-num=\"82\"></td><td><pre># It is recommended that you define on your system a unique user which the</pre></td></tr><tr><td data-num=\"83\"></td><td><pre># ftp server can use as a totally isolated and unprivileged user.</pre></td></tr><tr><td data-num=\"84\"></td><td><pre>#nopriv_user=ftpsecure</pre></td></tr><tr><td data-num=\"85\"></td><td><pre></pre></td></tr><tr><td data-num=\"86\"></td><td><pre># Enable this and the server will recognise asynchronous ABOR requests. Not</pre></td></tr><tr><td data-num=\"87\"></td><td><pre># recommended for security (the code is non-trivial). Not enabling it,</pre></td></tr><tr><td data-num=\"88\"></td><td><pre># however, may confuse older FTP clients.</pre></td></tr><tr><td data-num=\"89\"></td><td><pre>#async_abor_enable=YES</pre></td></tr><tr><td data-num=\"90\"></td><td><pre></pre></td></tr><tr><td data-num=\"91\"></td><td><pre># By default the server will pretend to allow ASCII mode but in fact ignore</pre></td></tr><tr><td data-num=\"92\"></td><td><pre># the request. Turn on the below options to have the server actually do ASCII</pre></td></tr><tr><td data-num=\"93\"></td><td><pre># mangling on files when in ASCII mode.</pre></td></tr><tr><td data-num=\"94\"></td><td><pre># Beware that on some FTP servers, ASCII support allows a denial of service</pre></td></tr><tr><td data-num=\"95\"></td><td><pre># attack (DoS) via the command \"SIZE /big/file\" in ASCII mode. vsftpd</pre></td></tr><tr><td data-num=\"96\"></td><td><pre># predicted this attack and has always been safe, reporting the size of the</pre></td></tr><tr><td data-num=\"97\"></td><td><pre># raw file.</pre></td></tr><tr><td data-num=\"98\"></td><td><pre># ASCII mangling is a horrible feature of the protocol.</pre></td></tr><tr><td data-num=\"99\"></td><td><pre>#ascii_upload_enable=YES</pre></td></tr><tr><td data-num=\"100\"></td><td><pre>#ascii_download_enable=YES</pre></td></tr><tr><td data-num=\"101\"></td><td><pre></pre></td></tr><tr><td data-num=\"102\"></td><td><pre># You may fully customise the login banner string:</pre></td></tr><tr><td data-num=\"103\"></td><td><pre>#ftpd_banner=Welcome to blah FTP service.</pre></td></tr><tr><td data-num=\"104\"></td><td><pre></pre></td></tr><tr><td data-num=\"105\"></td><td><pre># You may specify a file of disallowed anonymous e-mail addresses. Apparently</pre></td></tr><tr><td data-num=\"106\"></td><td><pre># useful for combatting certain DoS attacks.</pre></td></tr><tr><td data-num=\"107\"></td><td><pre>#deny_email_enable=YES</pre></td></tr><tr><td data-num=\"108\"></td><td><pre># (default follows)</pre></td></tr><tr><td data-num=\"109\"></td><td><pre>#banned_email_file=/etc/vsftpd.banned_emails</pre></td></tr><tr><td data-num=\"110\"></td><td><pre></pre></td></tr><tr><td data-num=\"111\"></td><td><pre># You may restrict local users to their home directories.  See the FAQ for</pre></td></tr><tr><td data-num=\"112\"></td><td><pre># the possible risks in this before using chroot_local_user or</pre></td></tr><tr><td data-num=\"113\"></td><td><pre># chroot_list_enable below.</pre></td></tr><tr><td data-num=\"114\"></td><td><pre>chroot_local_user=YES #用户访问将被限制在当前目录</pre></td></tr><tr><td data-num=\"115\"></td><td><pre></pre></td></tr><tr><td data-num=\"116\"></td><td><pre># You may specify an explicit list of local users to chroot() to their home</pre></td></tr><tr><td data-num=\"117\"></td><td><pre># directory. If chroot_local_user is YES, then this list becomes a list of</pre></td></tr><tr><td data-num=\"118\"></td><td><pre># users to NOT chroot().</pre></td></tr><tr><td data-num=\"119\"></td><td><pre># (Warning! chroot'ing can be very dangerous. If using chroot, make sure that</pre></td></tr><tr><td data-num=\"120\"></td><td><pre># the user does not have write access to the top level directory within the</pre></td></tr><tr><td data-num=\"121\"></td><td><pre># chroot)</pre></td></tr><tr><td data-num=\"122\"></td><td><pre>#chroot_local_user=YES</pre></td></tr><tr><td data-num=\"123\"></td><td><pre>#chroot_list_enable=YES</pre></td></tr><tr><td data-num=\"124\"></td><td><pre># (default follows)</pre></td></tr><tr><td data-num=\"125\"></td><td><pre>#chroot_list_file=/etc/vsftpd.chroot_list</pre></td></tr><tr><td data-num=\"126\"></td><td><pre></pre></td></tr><tr><td data-num=\"127\"></td><td><pre># You may activate the \"-R\" option to the builtin ls. This is disabled by</pre></td></tr><tr><td data-num=\"128\"></td><td><pre># default to avoid remote users being able to cause excessive I/O on large</pre></td></tr><tr><td data-num=\"129\"></td><td><pre># sites. However, some broken FTP clients such as \"ncftp\" and \"mirror\" assume</pre></td></tr><tr><td data-num=\"130\"></td><td><pre># the presence of the \"-R\" option, so there is a strong case for enabling it.</pre></td></tr><tr><td data-num=\"131\"></td><td><pre>#ls_recurse_enable=YES</pre></td></tr><tr><td data-num=\"132\"></td><td><pre></pre></td></tr><tr><td data-num=\"133\"></td><td><pre># Customization</pre></td></tr><tr><td data-num=\"134\"></td><td><pre>#</pre></td></tr><tr><td data-num=\"135\"></td><td><pre># Some of vsftpd's settings don't fit the filesystem layout by</pre></td></tr><tr><td data-num=\"136\"></td><td><pre># default.</pre></td></tr><tr><td data-num=\"137\"></td><td><pre>#</pre></td></tr><tr><td data-num=\"138\"></td><td><pre># This option should be the name of a directory which is empty.  Also, the</pre></td></tr><tr><td data-num=\"139\"></td><td><pre># directory should not be writable by the ftp user. This directory is used</pre></td></tr><tr><td data-num=\"140\"></td><td><pre># as a secure chroot() jail at times vsftpd does not require filesystem</pre></td></tr><tr><td data-num=\"141\"></td><td><pre># access.</pre></td></tr><tr><td data-num=\"142\"></td><td><pre>secure_chroot_dir=/var/run/vsftpd/empty</pre></td></tr><tr><td data-num=\"143\"></td><td><pre></pre></td></tr><tr><td data-num=\"144\"></td><td><pre># This string is the name of the PAM service vsftpd will use.</pre></td></tr><tr><td data-num=\"145\"></td><td><pre>pam_service_name=vsftpd</pre></td></tr><tr><td data-num=\"146\"></td><td><pre></pre></td></tr><tr><td data-num=\"147\"></td><td><pre># This option specifies the location of the RSA certificate to use for SSL</pre></td></tr><tr><td data-num=\"148\"></td><td><pre># encrypted connections.</pre></td></tr><tr><td data-num=\"149\"></td><td><pre>rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem</pre></td></tr><tr><td data-num=\"150\"></td><td><pre>rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key</pre></td></tr><tr><td data-num=\"151\"></td><td><pre>ssl_enable=NO</pre></td></tr><tr><td data-num=\"152\"></td><td><pre></pre></td></tr><tr><td data-num=\"153\"></td><td><pre></pre></td></tr><tr><td data-num=\"154\"></td><td><pre># Uncomment this to indicate that vsftpd use a utf8 filesystem.</pre></td></tr><tr><td data-num=\"155\"></td><td><pre>utf8_filesystem=YES</pre></td></tr><tr><td data-num=\"156\"></td><td><pre></pre></td></tr><tr><td data-num=\"157\"></td><td><pre></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>no_anon_password=YES #匿名登录是否需要密码</pre></td></tr><tr><td data-num=\"159\"></td><td><pre>anon_root=/home/user/ftp_dir #匿名登录访问的文件路径</pre></td></tr><tr><td data-num=\"160\"></td><td><pre></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>local_root=/ftp_share #实名登录访问的文件路径</pre></td></tr><tr><td data-num=\"162\"></td><td><pre></pre></td></tr><tr><td data-num=\"163\"></td><td><pre>allow_writeable_chroot=YES</pre></td></tr></table></figure><p>编辑完成后， <code>:wq</code>  保存退出。</p>\n<p>note：<mark>如果自己电脑的当前网络环境支持 ipv6 的话可以将  <code>listen_ipv6</code>  设置为 YES，但是  <code>listen</code>  就要设置为 NO，因为 ipv4 和 ipv6 的服务监听不能共存。</mark></p>\n<h1 id=\"重新加载配置文件\"><a class=\"anchor\" href=\"#重新加载配置文件\">#</a> 重新加载配置文件</h1>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> /etc/init.d/vsftpd restart</pre></td></tr></table></figure><h1 id=\"启动服务\"><a class=\"anchor\" href=\"#启动服务\">#</a> 启动服务</h1>\n<p>在加载完后，重启服务器：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> systemctl restart vsftpd</pre></td></tr></table></figure><p>查看服务启动状态：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> systemctl status vsftpd</pre></td></tr></table></figure><p><img data-src=\"image-20221106152005206.png\" alt=\"image-20221106152005206\" /></p>\n<p>设置开机启动：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> systemctl <span class=\"token builtin class-name\">enable</span> vsftpd</pre></td></tr></table></figure><p>如果想关闭开机启动：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> systemctl disable vsftpd</pre></td></tr></table></figure><h1 id=\"ftp连接\"><a class=\"anchor\" href=\"#ftp连接\">#</a> FTP 连接</h1>\n<p>本机连接：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">ftp</span> <span class=\"token number\">127.0</span>.0.1</pre></td></tr></table></figure><p>其它电脑连接：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ftp</span> <span class=\"token function\">ip</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># eg:ftp 192.168.0.3</span></pre></td></tr></table></figure><p>1、输入用户名：（1）匿名：anonymous 或 ftp （2）主机用户名：即你当前主机名。</p>\n<p>2、回车。</p>\n<p>3、如果需要密码则进行相应输入，这里上面配置设了匿名登录不需要密码，所以以匿名登录时没有提示输入密码。</p>\n<p>4、进入到相应的用户访问根目录里（ps：即进入到配置文件中设置的登录访问的文件路径，可以用  <code>ls</code>  查看是否对应上访问的文件目录），这样就可以愉快的玩耍了；输入：  <code>quit</code>  退出。</p>\n<p>eg：本地连接并退出，如下图：</p>\n<p><img data-src=\"image-20221106164252568.png\" alt=\"image-20221106164252568\" /></p>\n<p>windows 下可视化文件访问：按  <code>Win</code>  +  <code>E</code>  快捷键，调用文件资源管理器，输入访问地址，回车：</p>\n<p><img data-src=\"image-20221106160826118.png\" alt=\"image-20221106160826118\" /></p>\n<p>windows 下命令行文件访问：同样按  <code>Win</code>  +  <code>E</code>  快捷键，调用文件资源管理器，然后在输写框跟上面 linux 访问连接一样输入  <code>ftp ip</code>  ，即可跳到 ftp 操作控制台中：</p>\n<p><img data-src=\"image-20221106161411644.png\" alt=\"image-20221106161411644\" /></p>\n<h1 id=\"ftp客户端常用命令\"><a class=\"anchor\" href=\"#ftp客户端常用命令\">#</a> FTP 客户端常用命令</h1>\n<p>在登录进入 ftp 后，可以使用  <code>help</code>  查看可以使用哪些指令操作：</p>\n<p><img data-src=\"image-20221106163512272.png\" alt=\"image-20221106163512272\" /></p>\n<ul>\n<li>\n<p>ls：和 linux 上的 ls 命令类似</p>\n</li>\n<li>\n<p>Ctrl+Shift + L：清屏</p>\n</li>\n<li>\n<p>put：使用  <code>put [本地文件路径+名称]</code>  上传</p>\n</li>\n<li>\n<p>get：使用  <code>get [远程文件路径+名称]</code>  下载</p>\n</li>\n<li>\n<p>mput：批量上传多个文件  <code>mput 文件名1 文件名2</code></p>\n</li>\n<li>\n<p>mget：批量获取多个文件  <code>mget 文件名1 文件名2</code></p>\n</li>\n<li>\n<p>prompt：屏蔽批量输出信息，批量上传下载文件就不需要一直回车确认了</p>\n</li>\n<li>\n<p>quit：退出 ftp 访问</p>\n</li>\n</ul>\n",
            "tags": [
                "history",
                "Ubuntu",
                "Linux"
            ]
        }
    ]
}